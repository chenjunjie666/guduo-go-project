(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ab6c74e"],{3707:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"dataForm",staticStyle:{width:"80%"},attrs:{size:"small",rules:t.rules,model:t.detail,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"电影名",prop:"name"}},[a("el-input",{model:{value:t.detail.name,callback:function(e){t.$set(t.detail,"name",e)},expression:"detail.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"类型",prop:"name"}},[t.config?a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.detail.sub_show_type,callback:function(e){t.$set(t.detail,"sub_show_type",e)},expression:"detail.sub_show_type"}},t._l(t.config.show_type[t.show_type].sub_show_type,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):t._e()],1),t._v(" "),a("el-form-item",{attrs:{label:"是否自制",prop:"name"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},model:{value:t.detail.is_self,callback:function(e){t.$set(t.detail,"is_self",e)},expression:"detail.is_self"}})],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-form-item",{attrs:{label:"是否改编",prop:"name"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},model:{value:t.detail.is_adapt,callback:function(e){t.$set(t.detail,"is_adapt",e)},expression:"detail.is_adapt"}})],1)],1),t._v(" "),a("el-col",{directives:[{name:"show",rawName:"v-show",value:t.detail.is_adapt,expression:"detail.is_adapt"}],attrs:{span:12}},[a("el-form-item",{attrs:{label:"改编自",prop:"name"}},[a("el-input",{model:{value:t.detail.adapt_from,callback:function(e){t.$set(t.detail,"adapt_from",e)},expression:"detail.adapt_from"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上线时间",prop:"name"}},[a("el-date-picker",{staticStyle:{width:"80%"},attrs:{format:"yyyy 年 MM 月 dd 日","value-format":"timestamp",type:"date",placeholder:"Pick a date"},model:{value:t.detail.release_at,callback:function(e){t.$set(t.detail,"release_at",e)},expression:"detail.release_at"}})],1)],1),t._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"完结时间",prop:"name"}},[a("el-date-picker",{staticStyle:{width:"80%"},attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"timestamp",placeholder:"Pick a date"},model:{value:t.detail.end_at,callback:function(e){t.$set(t.detail,"end_at",e)},expression:"detail.end_at"}})],1)],1)],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"时长",prop:"name"}},[a("el-input",{model:{value:t.detail.length,callback:function(e){t.$set(t.detail,"length",e)},expression:"detail.length"}})],1)],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"剧集描述",prop:"name"}},[a("el-input",{attrs:{type:"textarea",rows:3},model:{value:t.detail.introduction,callback:function(e){t.$set(t.detail,"introduction",e)},expression:"detail.introduction"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"海报",prop:"name"}},[a("el-upload",{staticClass:"poster-uploader",attrs:{action:t.host+"/upload?debug=1","show-file-list":!1,"on-success":t.handlePosterSuccess,"before-upload":t.beforePosterUpload}},[t.detail.poster?a("img",{staticClass:"poster",attrs:{src:t.detail.poster}}):a("i",{staticClass:"el-icon-plus poster-uploader-icon"})])],1),t._v(" "),t.config?a("el-form-item",{attrs:{label:"导演",prop:"name"}},[a("div",[a("staff-item",{attrs:{staffs:t.detail.director},on:{add:function(e){return t.detail.director.push(e)},del:function(e){return t.detail.director.splice(e,1)},"update:staffs":function(e){return t.$set(t.detail,"director",e)}}})],1)]):t._e(),t._v(" "),t.config&&t.detail.staff?a("el-form-item",{attrs:{label:"主创人员",prop:"name"}},t._l(t.staff_type,(function(e){return a("div",[a("span",[t._v(t._s(e.name))]),t._v(" "),a("staff-item",{attrs:{staffs:t.detail.staff[e.id]},on:{add:function(a){t.detail.staff[e.id].push(a)},del:function(a){t.detail.staff[e.id].splice(a,1)},"update:staffs":function(a){return t.$set(t.detail.staff,e.id,a)}}})],1)})),0):t._e(),t._v(" "),t.config?a("el-form-item",{attrs:{label:"综艺支持人/嘉宾等",prop:"name"}},[t._l(t.detail.actor,(function(e,i){return a("div",{key:i},[a("actor-item",{attrs:{item:e,config:t.config.play_type},on:{add:function(a){return t.detail.actor.splice(i+1,0,{name:"",play:"",play_type:e.play_type})},del:function(e){return t.detail.actor.splice(i,1)},"update:item":function(t){e=t}}})],1)})),t._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.detail.actor&&0==t.detail.actor.length,expression:"detail.actor&&detail.actor.length==0"}],staticStyle:{width:"503px"},on:{click:function(e){return t.detail.actor.push({name:"",play_type:t.config.play_type[0].id})}}},[t._v("\n        +新增\n      ")])],2):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"放映状态",prop:"name"}},[a("el-radio-group",{model:{value:t.detail.show_status,callback:function(e){t.$set(t.detail,"show_status",e)},expression:"detail.show_status"}},[a("el-radio",{attrs:{label:0}},[t._v("在播")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("待播")]),t._v(" "),a("el-radio",{attrs:{label:2}},[t._v("下架")]),t._v(" "),a("el-radio",{attrs:{label:3}},[t._v("无效")])],1)],1),t._v(" "),t.config?a("el-form-item",{attrs:{label:"视频平台链接",prop:"name"}},[t._l(t.detail.link,(function(e,i){return a("div",{key:i},[a("link-item",{attrs:{item:e,config:t.config.platform},on:{del:function(e){return t.detail.link.splice(i,1)},"update:item":function(t){e=t}}})],1)})),t._v(" "),a("el-button",{staticStyle:{width:"615px"},on:{click:function(e){return t.detail.link.push({url:"",platform_id:t.config.platform[0].id})}}},[t._v("\n        +新增\n      ")])],2):t._e(),t._v(" "),t.config?a("el-form-item",{attrs:{label:"类型题材标签",prop:"name"}},[a("el-select",{attrs:{multiple:"",placeholder:"请选择"},model:{value:t.detail.tag,callback:function(e){t.$set(t.detail,"tag",e)},expression:"detail.tag"}},t._l(t.config.tag,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1)],1):t._e(),t._v(" "),a("el-form-item",{attrs:{label:"是否在小程序显示",prop:"name"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66"},model:{value:t.detail.is_show,callback:function(e){t.$set(t.detail,"is_show",e)},expression:"detail.is_show"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"审核状态",prop:"name"}},[a("el-radio-group",{model:{value:t.detail.status,callback:function(e){t.$set(t.detail,"status",e)},expression:"detail.status"}},[a("el-radio",{attrs:{label:-1}},[t._v("拒绝")]),t._v(" "),a("el-radio",{attrs:{label:0}},[t._v("待审核")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("通过")])],1)],1),t._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){}}},[t._v("\n        取消\n      ")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("\n        提交\n      ")])],1)],1)],1)},l=[],n=(a("a481"),a("b54a"),a("db72")),s=a("b775"),r=a("7590"),o=a("bcec"),c=a("59bd"),u=a("4ec3"),d={name:"name",components:{staffItem:r["a"],actorItem:o["a"],linkItem:c["a"]},data:function(){return{host:s["a"],show_type:2,detail:{},staff_type:[{name:"编剧",id:"screen_writer"},{name:"制片人",id:"producer"},{name:"制片公司",id:"producer_company"},{name:"出品人",id:"publisher"},{name:"出品公司",id:"publisher_company"}],rules:{role_id:[{required:!0,message:"type is required",trigger:"change"}],timestamp:[{type:"date",required:!0,message:"timestamp is required",trigger:"change"}],email:[{required:!0,message:"title is required",trigger:"blur"}]},config:null}},mounted:function(){this.getConfig(),this.$route.params.id?this.getData():this.resetTemp()},methods:{getConfig:function(){var t=this;Object(u["f"])().then((function(e){t.config=e.data}))},pushStaff:function(t,e){},getData:function(){var t=this;Object(u["h"])({show_id:1*this.$route.params.id}).then((function(e){e.data.release_at=e.data.release_at?1e3*e.data.release_at:null,e.data.end_at=e.data.end_at?1e3*e.data.end_at:null,t.detail=e.data}))},resetTemp:function(){this.detail={show_type:this.show_type,sub_show_type:"",name:"",is_self:!1,is_adapt:!0,adapt_from:"",release_at:"",end_at:"",length:"",total_episode:36,poster:"",introduction:"",show_status:1,link:[],director:[],staff:{screen_writer:[],producer:[],producer_company:[],publisher:[],publisher_company:[]},actor:[],tag:[],status:0,is_show:1}},createData:function(){var t=this;console.log(this.detail),this.$refs["dataForm"].validate((function(e){if(e){var a=Object(n["a"])({},t.detail);a.release_at=a.release_at?a.release_at/1e3:0,a.end_at=a.end_at?a.end_at/1e3:0,a.link=JSON.stringify(a.link),a.staff=JSON.stringify(a.staff),a.director=JSON.stringify(a.director),a.tag=JSON.stringify(a.tag),a.actor=JSON.stringify(a.actor),t.$route.params.id?t.showEdit(a):t.showAdd(a)}}))},showAdd:function(t){var e=this;Object(u["e"])(t).then((function(t){e.$notify({title:"Success",type:"success",duration:2e3})}))},showEdit:function(t){var e=this;Object(u["i"])(t).then((function(t){e.$notify({title:"Success",type:"success",duration:2e3}),e.$router.replace({name:"movie-edit",params:{id:t.data.show_id}})}))},handleUpdate:function(t){var e=this;this.detail=Object.assign({},t),console.log(this.detail),this.detail.timestamp=new Date(this.detail.timestamp),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick((function(){e.$refs["dataForm"].clearValidate()}))},handlePosterSuccess:function(t,e){this.detail.poster=t.data.url},beforePosterUpload:function(t){t.type,t.size;return!0}}},p=d,f=(a("6266"),a("2877")),m=Object(f["a"])(p,i,l,!1,null,null,null);e["default"]=m.exports},"386b":function(t,e,a){var i=a("5ca1"),l=a("79e5"),n=a("be13"),s=/"/g,r=function(t,e,a,i){var l=String(n(t)),r="<"+e;return""!==a&&(r+=" "+a+'="'+String(i).replace(s,"&quot;")+'"'),r+">"+l+"</"+e+">"};t.exports=function(t,e){var a={};a[t]=e(r),i(i.P+i.F*l((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3})),"String",a)}},4603:function(t,e,a){},"59bd":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-bottom":"5px"}},[a("el-input",{staticStyle:{width:"400px","margin-right":"10px"},model:{value:t.item.url,callback:function(e){t.$set(t.item,"url",e)},expression:"item.url"}}),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.item.platform_id,callback:function(e){t.$set(t.item,"platform_id",e)},expression:"item.platform_id"}},t._l(t.config,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),a("el-button-group",[a("el-button",{attrs:{icon:"el-icon-minus"},on:{click:function(e){return t.$emit("del")}}})],1)],1)},l=[],n={name:"staffItem",props:{item:{type:Object,default:function(){}},config:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{}},s=n,r=a("2877"),o=Object(r["a"])(s,i,l,!1,null,"6613b9e4",null);e["a"]=o.exports},6266:function(t,e,a){"use strict";var i=a("9401"),l=a.n(i);l.a},7590:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._l(t.staffs,(function(e){return a("el-tag",{key:e,attrs:{type:t.theme,closable:"","disable-transitions":!1},on:{close:function(a){return t.handleClose(e)}}},[t._v("\n    "+t._s(e)+"\n  ")])})),t._v(" "),t.inputVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm(e)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 新增")])],2)},l=[],n={props:{theme:{type:String,default:"primary"},staffs:{type:Array,default:function(){return[]}}},data:function(){return{inputVisible:!1,inputValue:""}},methods:{handleClose:function(t){this.$emit("del",this.staffs.indexOf(t))},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick((function(e){t.$refs.saveTagInput.$refs.input.focus()}))},handleInputConfirm:function(){var t=this.inputValue;t&&this.$emit("add",t),this.inputVisible=!1,this.inputValue=""}}},s=n,r=(a("85f8"),a("2877")),o=Object(r["a"])(s,i,l,!1,null,"571d98e4",null);e["a"]=o.exports},"85f8":function(t,e,a){"use strict";var i=a("4603"),l=a.n(i);l.a},9401:function(t,e,a){},b54a:function(t,e,a){"use strict";a("386b")("link",(function(t){return function(e){return t(this,"a","href",e)}}))},bcec:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"margin-bottom":"5px"}},[a("span",[t._v("姓名:")]),t._v(" "),a("el-input",{staticStyle:{width:"150px","margin-right":"10px"},model:{value:t.item.name,callback:function(e){t.$set(t.item,"name",e)},expression:"item.name"}}),t._v(" "),a("span",[t._v("饰演:")]),t._v(" "),a("el-input",{staticStyle:{width:"150px","margin-right":"10px"},model:{value:t.item.play,callback:function(e){t.$set(t.item,"play",e)},expression:"item.play"}}),t._v(" "),a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.item.play_type,callback:function(e){t.$set(t.item,"play_type",e)},expression:"item.play_type"}},t._l(t.config,(function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),a("el-button-group",[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:function(e){return t.$emit("add")}}}),t._v(" "),a("el-button",{attrs:{icon:"el-icon-minus"},on:{click:function(e){return t.$emit("del")}}})],1)],1)},l=[],n={name:"staffItem",props:{item:{type:Object,default:function(){}},config:{type:Array,default:function(){return[]}}},data:function(){return{}},methods:{}},s=n,r=a("2877"),o=Object(r["a"])(s,i,l,!1,null,"6bea7400",null);e["a"]=o.exports}}]);